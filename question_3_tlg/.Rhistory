library(ggplot2)
library(dplyr)
library(tidyverse)
adae <- pharmaverseadam::adae
ggplot(adae, aes(x = ACTARM, fill = AESEV)) +
geom_bar(stat = "count", position = "stack") +
labs(
title = "AE Severity Distribution by Treatment",
x = "Treatment Group",
y = "Count of AEs",
fill = "AE Severity"
) +
theme_bw() +
scale_fill_manual(
values = c(
"MILD" = "#A6CEE3",
"MODERATE" = "#1F78B4",
"SEVERE" = "#B2182B"
)
) +
theme(
legend.position = "right"
)
# ---- Plot 2 ----
# Top 10 most frequent AEs (with 95% CI for incidence rates).
# AEs are captured in the AETERM variable in the pharmaverseadam::adae dataset.
# total number of subjects in safety population
n_subj <- adae %>%
filter(SAFFL == "Y") %>%
distinct(USUBJID) %>%
nrow()
# calculate incidence rates and Clopper–Pearson CI
ae_10 <- adae %>%
distinct(USUBJID, AETERM) %>%
count(AETERM, name = "total") %>%
arrange(desc(total)) %>%
slice_head(n = 10) %>%
mutate(n_subj = n_subj)
plot_df <- ae_10 %>%
rowwise() %>%
mutate(
ci = list(binom.test(total, n_subj, conf.level = 0.95))$conf.int,
prop = total / n_subj,
lower = ci[1],
upper = ci[2]
)
ae_10 %>%
rowwise() %>%
mutate(
ci = list(binom.test(total, n_subj, conf.level = 0.95))$conf.int,
prop = total / n_subj,
lower = ci[1],
upper = ci[2]
)
ae_10
attach(ae_10)
binom.test(total, n_subj, conf.level = 0.95)$conf.int
binom.test(total[1], n_subj[1], conf.level = 0.95)$conf.int
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
plot_df <- ae_10 %>%
rowwise() %>%
mutate(
ci = binom.test(total, n_subj, conf.level = 0.95),
prop = total / n_subj
)
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
binom.test(total[1], n_subj[1], conf.level = 0.95)$conf.int
list(binom.test(total[1], n_subj[1], conf.level = 0.95))$conf.int
list(binom.test(total[1], n_subj[1], conf.level = 0.95)$conf.int)
binom.test(total[1], n_subj[1], conf.level = 0.95)
prop.test(total[1], n_subj[1], conf.level = 0.95)
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
plot_df <- ae_10 %>%
rowwise() %>%
mutate(
ci = list(binom.test(total, n_subj, conf.level = 0.95)$conf.int),
prop = total / n_subj,
lower = ci[1],
upper = ci[2]
)
plot_df
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
plot_df <- ae_10 %>%
rowwise() %>%
mutate(
ci = list(binom.test(total, n_subj, conf.level = 0.95)$conf.int),
incidence_pct = total / n_subj,
lower = ci[1],
upper = ci[2]
)
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 3, color = "#1F78B4") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
height = 0.2,
color = "#1F78B4"
) +
labs(
title = "Top 10 Most Frequent Treatment-Emergent Adverse Events",
x = "Incidence (%) with 95% CI",
y = "Adverse Event Term"
) +
theme_minimal()
plot_df
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
plot_df <- ae_10 %>%
rowwise() %>%
mutate(
ci = list(binom.test(total, n_subj, conf.level = 0.95)$conf.int),
incidence_pct = total / n_subj,
lower_pct = ci[1],
upper_pct = ci[2]
)
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 3, color = "#1F78B4") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
height = 0.2,
color = "#1F78B4"
) +
labs(
title = "Top 10 Most Frequent Treatment-Emergent Adverse Events",
x = "Incidence (%) with 95% CI",
y = "Adverse Event Term"
) +
theme_minimal()
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
ae_10 <- ae_10 %>%
mutate(AETERM = factor(AETERM, levels = AETERM))
plot_df <- ae_10 %>%
rowwise() %>%
mutate(
ci = list(binom.test(total, n_subj, conf.level = 0.95)$conf.int),
incidence_pct = total / n_subj,
lower_pct = ci[1],
upper_pct = ci[2]
)
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 3, color = "#1F78B4") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
height = 0.2,
color = "#1F78B4"
) +
labs(
title = "Top 10 Most Frequent Treatment-Emergent Adverse Events",
x = "Incidence (%) with 95% CI",
y = "Adverse Event Term"
) +
theme_minimal()
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 3, color = "#1F78B4") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
height = 0.2,
color = "#1F78B4"
) +
labs(
title = "Top 10 Most Frequent Treatment-Emergent Adverse Events",
x = "Incidence (%) with 95% CI",
y = "Adverse Event Term"
) +
theme_bw()
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "#1F78B4") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
height = 0.2,
color = "#1F78B4"
) +
labs(
title = "Top 10 Most Frequent Treatment-Emergent Adverse Events",
x = "Incidence (%) with 95% CI",
y = "Adverse Event Term"
) +
theme_bw()
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "#1F78B4") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
height = 0.2,
color = "#1F78B4"
) +
labs(
title = "Top 10 Most Frequent Adverse Events",
x = "Incidence (%) with 95% CI",
y = "Adverse Event Term"
) +
theme_bw()
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "#1F78B4") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
height = 0.2,
color = "#1F78B4"
) +
labs(
title = "Top 10 Most Frequent Adverse Events",
subtitle = "n = 225, 95% Clopper-Pearson CI",
x = "Incidence (%) with 95% CI",
y = "Adverse Event Term"
) +
theme_bw()
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "#1F78B4") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
height = 0.2,
color = "#1F78B4"
) +
labs(
title = "Top 10 Most Frequent Adverse Events",
subtitle = "n = 225, 95% Clopper-Pearson CI",
x = "Incidence (%) with 95% CI",
y = "Adverse Event Term"
) +
theme_bw()
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R", echo = TRUE)
# calculate incidence rates and Clopper–Pearson CI
ae_10 <- adae %>%
distinct(USUBJID, AETERM) %>%
count(AETERM, name = "total") %>%
arrange(desc(total)) %>%
slice_head(n = 10) %>%
mutate(n_subj = n_subj)
ae_10 <- ae_10 %>%
mutate(AETERM = factor(AETERM, levels = AETERM))
plot_df <- ae_10 %>%
rowwise() %>%
mutate(
ci = list(binom.test(total, n_subj, conf.level = 0.95)$conf.int),
incidence_pct = total / n_subj,
lower_pct = ci[1],
upper_pct = ci[2]
)
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "#1F78B4") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
height = 0.2,
color = "#1F78B4"
) +
labs(
title = "Top 10 Most Frequent Adverse Events",
subtitle = "n = 225, 95% Clopper-Pearson CI",
x = "Incidence (%) with 95% CI",
y = "Adverse Event Term"
) +
theme_bw()
ae_10
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "#1F78B4") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
height = 0.2,
color = "#1F78B4"
) +
labs(
title = "Top 10 Most Frequent Adverse Events",
# subtitle = "n = 225, 95% Clopper-Pearson CI",
x = "Incidence (%) with 95% CI",
y = "Adverse Event Term"
) +
theme_bw()
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "#1F78B4") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
height = 0.2,
color = "#1F78B4"
) +
labs(
title = "Top 10 Most Frequent Adverse Events",
subtitle = "n = 225, 95% Clopper-Pearson CI",
x = "Percentage of Patients(%)",
y = "Adverse Event Term",
) +
theme_bw()
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "#1F78B4") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
height = 0.2,
color = "#1F78B4"
) +
labs(
title = "Top 10 Most Frequent Adverse Events",
subtitle = "n = 225, 95% Clopper-Pearson CI",
x = "Percentage of Patients(%)",
y = "AEs",
) +
theme_bw()
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "#1F78B4") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
height = 0.2,
color = "#1F78B4"
) +
labs(
title = "Top 10 Most Frequent Adverse Events",
subtitle = "n = 225, 95% Clopper-Pearson CI",
x = "Percentage of Patients(%)"
) +
theme_bw()
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "steelblue") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
height = 0.2,
color = "steelblue"
) +
labs(
title = "Top 10 Most Frequent Adverse Events",
subtitle = "n = 225, 95% Clopper-Pearson CI",
x = "Percentage of Patients(%)",
y = "AEs",
) +
theme_bw()
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "steelblue") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
width = 0.2,
color = "steelblue"
) +
labs(
title = "Top 10 Most Frequent Adverse Events",
subtitle = "n = 225, 95% Clopper-Pearson CI",
x = "Percentage of Patients(%)",
y = "AEs",
) +
theme_bw()
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R", echo = TRUE)
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
plot_df <- plot_df %>%
mutate(AETERM = factor(AETERM, levels = AETERM))
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "steelblue") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
width = 0.2,
color = "steelblue"
) +
labs(
title = "Top 10 Most Frequent Adverse Events",
subtitle = "n = 225, 95% Clopper-Pearson CI",
x = "Percentage of Patients(%)",
y = "AEs",
) +
theme_bw()
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
plot_df <- plot_df %>%
mutate(AETERM = factor(AETERM, levels = -AETERM))
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
plot_df <- plot_df %>%
mutate(AETERM = factor(AETERM, levels = AETERM)) %>%
arrange(incidence_pct)
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "steelblue") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
width = 0.2,
color = "steelblue"
) +
labs(
title = "Top 10 Most Frequent Adverse Events",
subtitle = "n = 225, 95% Clopper-Pearson CI",
x = "Percentage of Patients(%)",
y = "AEs",
) +
theme_bw()
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R", echo = TRUE)
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "steelblue") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
width = 0.2,
color = "steelblue"
) +
labs(
title = "Top 10 Most Frequent Adverse Events",
subtitle = "n = 225, 95% Clopper-Pearson CI",
x = "Percentage of Patients(%)",
y = "AEs",
) +
theme_bw()
sink("02_create_visualizations.txt", type = c("output", "message"))
library(pharmaverseadam)
library(ggplot2)
library(dplyr)
library(tidyverse)
adae <- pharmaverseadam::adae
# ---- Plot 1 ----
# AE severity distribution by treatment (bar chart or heatmap).
# AE Severity is captured in the AESEV variable in pharmaverseadam::adae dataset.
ggplot(adae, aes(x = ACTARM, fill = AESEV)) +
geom_bar(stat = "count", position = "stack") +
labs(
title = "AE Severity Distribution by Treatment",
x = "Treatment Group",
y = "Count of AEs",
fill = "AE Severity"
) +
theme_bw() +
scale_fill_manual(
values = c(
"MILD" = "#A6CEE3",
"MODERATE" = "#1F78B4",
"SEVERE" = "#B2182B"
)
) +
theme(
legend.position = "right"
)
# ---- Plot 2 ----
# Top 10 most frequent AEs (with 95% CI for incidence rates).
# AEs are captured in the AETERM variable in the pharmaverseadam::adae dataset.
# total number of subjects in safety population
n_subj <- adae %>%
filter(SAFFL == "Y") %>%
distinct(USUBJID) %>%
nrow()
# calculate incidence rates and Clopper–Pearson CI
ae_10 <- adae %>%
distinct(USUBJID, AETERM) %>%
count(AETERM, name = "total") %>%
arrange(desc(total)) %>%
slice_head(n = 10) %>%
mutate(n_subj = n_subj)
plot_df <- ae_10 %>%
rowwise() %>%
mutate(
ci = list(binom.test(total, n_subj, conf.level = 0.95)$conf.int),
incidence_pct = total / n_subj,
lower_pct = ci[1],
upper_pct = ci[2]
)
plot_df <- plot_df %>%
mutate(AETERM = factor(AETERM, levels = AETERM)) %>%
arrange(incidence_pct)
ggplot(plot_df, aes(x = incidence_pct, y = AETERM)) +
geom_point(size = 2, color = "steelblue") +
geom_errorbar(
aes(xmin = lower_pct, xmax = upper_pct),
width = 0.2,
color = "steelblue"
) +
labs(
title = "Top 10 Most Frequent Adverse Events",
subtitle = "n = 225, 95% Clopper-Pearson CI",
x = "Percentage of Patients(%)",
y = "AEs",
) +
theme_bw()
sink()
ggplot(adae, aes(x = ACTARM, fill = AESEV)) +
geom_bar(stat = "count", position = "stack") +
labs(
title = "AE Severity Distribution by Treatment",
x = "Treatment Group",
y = "Count of AEs",
fill = "AE Severity"
) +
theme_bw() +
scale_fill_manual(
values = c(
"MILD" = "#A6CEE3",
"MODERATE" = "#1F78B4",
"SEVERE" = "#B2182B"
)
) +
theme(
legend.position = "right"
)
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
sink("02_create_visualizations.txt", type = c("output", "message"))
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R", echo = TRUE)
getwd()
sink("02_create_visualizations.txt")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R", echo = TRUE)
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R", echo = TRUE)
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R", echo = TRUE)
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R", echo = TRUE)
getwd()
setwd("~/Documents/GitHub/coding_assessment/question_3_tlg")
source("~/Documents/GitHub/coding_assessment/question_3_tlg/02_create_visualizations.R", echo = TRUE)
source("~/Documents/GitHub/coding_assessment/question_3_tlg/01_create_ae_summary_table.R", echo = TRUE)
python -m venv ae_agent_env
getwd()
reticulate::repl_python()
